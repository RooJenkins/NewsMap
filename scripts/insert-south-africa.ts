import 'dotenv/config'
import { PrismaClient } from '@prisma/client'

const prisma = new PrismaClient()

// South Africa location details
const SOUTH_AFRICA = {
  name: 'South Africa',
  type: 'country',
  lat: -30.5595,
  lng: 22.9375,
  country: 'South Africa'
}

// Comprehensive South Africa summary based on November 2025 research
const SOUTH_AFRICA_SUMMARY = `# South Africa

Here's the scene in Pretoria on November 3, 2025: President Cyril Ramaphosa gathers the leaders of ten political parties at the Cradle of Humankind—quite the metaphor—for their first meeting in 177 days. They emerge declaring the Government of National Unity "united and strong." Analysts, meanwhile, call it a "mixed bag." Translation: South Africa's grand coalition experiment is wobbling. The ANC, which governed unchallenged for three decades post-apartheid, lost its parliamentary majority in 2024 and was forced into bed with the center-right Democratic Alliance—its ideological opposite. Now the honeymoon's over, budget battles are erupting, John Steenhuisen's complaining about being excluded from decisions, and whispers are growing that Ramaphosa might not last until 2029. Add in load shedding that keeps flickering back to life, unemployment at 33%, and a G20 presidency that's forcing South Africa to choose sides between China-Russia and the West, and you've got a country at a crossroads. The question isn't whether South Africa can hold it together—it's how long before something snaps.

**The Big Issue 1: The GNU Coalition—Can This Marriage Survive?**

Let's be clear: the Government of National Unity wasn't born from choice—it was born from necessity. When the ANC lost its parliamentary majority in the 2024 elections for the first time since 1994, Ramaphosa had two options: coalition or chaos. He chose coalition, bringing together ten parties spanning the ideological spectrum, with the Democratic Alliance (DA)—historically the ANC's fiercest opponent—as his reluctant partner. It's a bit like inviting your ex to co-parent. Awkward doesn't begin to cover it.

Fast-forward to November 2025, and the cracks are showing. The November 3 retreat was supposed to project unity, but the fact they hadn't met in 177 days tells you everything. Steenhuisen, the DA leader, has publicly griped that Ramaphosa sidelines him from key decisions—not exactly the spirit of partnership. The 2025 budget process turned into a battleground, with parties squabbling over fiscal priorities, and the GNU leaders had to publicly commit to "more effective consultation" going forward. When you have to promise to consult each other, you know the relationship's in trouble.

Then there's the elephant in the room: Ramaphosa's own future. Media reports suggest a growing sentiment within the ANC that Ramaphosa may step down before his term ends in 2029. Confidence in his leadership is eroding, not just because of the coalition's strains, but because the ANC itself is fractured. Some factions resent the DA partnership; others blame Ramaphosa for the party's electoral collapse. The municipal governance crisis—Ramaphosa's urgent plea for GNU parties to "rescue" failing municipalities—underscores how overwhelmed the system is.

So can this marriage survive? Probably, but it won't be pretty. Both the ANC and DA have too much to lose from collapse. The ANC needs the DA's administrative competence and private-sector credibility; the DA needs the ANC's political reach. But expect more public spats, more budget battles, and more whispers about Ramaphosa's exit. The real risk? That the coalition's internal dysfunction paralyzes governance at the exact moment South Africa needs decisive action on the economy, energy, and unemployment.

**The Big Issue 2: Load Shedding—Is the Power Crisis Really Over?**

For a brief, glorious moment in 2024, South Africans thought they'd turned a corner on load shedding. The country endured only 69 days of blackouts in 2024—down from a staggering 300 days in 2023. Eskom, the beleaguered state power utility, managed to push its Energy Availability Factor up to 67% by July 2024, the highest since 2021. Politicians declared victory. Citizens dared to hope. Then January 2025 arrived, and Stage 3 load shedding came roaring back after nearly ten months of reprieve.

Now, as November 2025 rolls around, the picture is maddeningly inconsistent. Some provinces are bracing for extended Stage 4 load shedding. Other reports suggest the grid is stable, operating comfortably within capacity. What's the truth? Both. Eskom's infrastructure is so fragile that a few breakdowns can plunge the system into crisis overnight. The Energy Availability Factor has hovered below 60% for most of 2025, and unplanned outages remain at an unacceptable 28%. In other words, Eskom is one bad week away from plunging South Africa back into darkness.

The deeper problem is structural. South Africa isn't adding new generation capacity fast enough to replace its aging coal fleet, which Eskom plans to decommission over the next decade to meet climate commitments. Renewable energy projects are progressing, but bureaucratic delays, grid connection bottlenecks, and financing challenges mean they're not coming online fast enough. Meanwhile, the energy sector's circular debt has climbed to PKR 1.7 trillion (wait, that's Pakistan's number—South Africa's figures are equally dire but measured in rand). Independent power producers are frustrated, investors are wary, and the government's energy reform agenda is stalling amid coalition infighting.

For businesses, this is a nightmare. Every bout of load shedding costs the economy billions. Factories shut down. Supply chains rupture. Investors flee. The DA has been pushing for radical Eskom restructuring and faster private-sector involvement, but the ANC's left flank resists privatization, fearing job losses and loss of state control. So South Africa muddles through, lurching from crisis to crisis, praying the lights stay on. Spoiler alert: they won't always.

**The Big Issue 3: The Economy—Stagnation, Unemployment, and the Rand's Rollercoaster**

If you're looking for economic good news in South Africa, you'll need a microscope. GDP growth for 2025 is projected at a measly 1.3% (OECD estimate)—though that's generous; the World Bank pegs it at 0.9%. For a country with South Africa's potential, this is stagnation. The unemployment rate hit 33.2% in Q2 2025, up from 32.6% in Q1. But the truly gut-wrenching figure is youth unemployment: 62.2% of South Africans aged 15-24 are jobless. Read that again. Nearly two-thirds of young people have no work. This isn't an economic statistic—it's a social time bomb.

The government is trapped between competing pressures. On one hand, it's pursuing contractionary fiscal policy—cutting spending to stabilize debt. On the other hand, the South African Reserve Bank has been easing monetary policy since late 2024 to support economic activity. The result? A policy mix that's neither fish nor fowl, satisfying no one and achieving little. Consumer price inflation is forecast at 4.5% in 2025—manageable, but only because demand is so weak.

Then there's the rand, South Africa's perpetually jittery currency. It averaged R18.82 to the dollar in 2025, down from R18.32 in 2024. The exchange rate took a sharp dive in early April, though it's since recovered somewhat. But the rand remains "very unpredictable," buffeted by global economic shifts, commodity price swings, and South Africa's own political turbulence. Every time Ramaphosa's coalition wobbles, the rand shudders.

Foreign direct investment? Anemic. Investors look at South Africa and see political uncertainty, energy unreliability, policy drift, and sky-high unemployment. They see a country that should be thriving—blessed with minerals, infrastructure, and human capital—but is instead trapped in low gear. The GNU's fiscal battles aren't helping. The DA wants aggressive pro-business reforms; the ANC's left wing wants redistribution and state intervention. The compromise? Paralysis.

Here's the kicker: without faster growth, nothing else gets solved. No growth means no jobs. No jobs means no political stability. No political stability means no investment. It's a vicious cycle, and South Africa is spinning deeper into it.

**The International Angle: G20, BRICS, and the Great Power Squeeze**

South Africa's international position in November 2025 is complicated, to put it mildly. On one hand, it's hosting the G20 summit—a prestige moment that positions South Africa as a bridge between the Global South and the developed world. On the other hand, it's a member of BRICS, increasingly dominated by China and Russia, who view the G20 as a Western-led forum they're trying to counter.

The contradictions are glaring. In early November, South Africa postponed a joint BRICS naval exercise with Russia and China—originally slated for November 2025—citing "activities related to South Africa's G20 Presidency." Diplomatic translation: hosting the G20 while conducting military drills with two countries the West views as adversaries would've been, shall we say, awkward. But the postponement isn't a cancellation. This would've been the third iteration of the BRICS naval exercise, a biennial event designed to showcase military cooperation between South Africa, Russia, and China. It's coming back—just not during G20 season.

Behind the scenes, South Africa is deepening ties with Beijing and Moscow. On June 10, 2025, South Africa's defense chief, Rudzani Maphwanya, met China's defense minister in Beijing and pledged to expand military cooperation—likely driven by South Africa's chronic naval readiness issues and China's willingness to provide cheap equipment and training. On August 26, South Africa's navy chief received a Russian medal for "strengthening naval cooperation." These aren't symbolic gestures—they signal a strategic tilt.

Yet South Africa can't afford to alienate the West entirely. The US, EU, and UK remain critical trade partners, investors, and sources of development finance. South Africa exports everything from platinum to wine to Europe and America. Cutting ties with the West isn't an option. But neither is abandoning BRICS, where South Africa positions itself as Africa's representative and leverages the bloc for economic deals, infrastructure financing, and diplomatic clout.

So South Africa is caught in the middle—what analysts call a "swing state" in the emerging Cold War 2.0 between the US-led liberal bloc and the China-Russia revisionist axis. Washington and Beijing are both courting Pretoria, and Ramaphosa is playing both sides. The G20 presidency gives South Africa a platform to assert its non-aligned credentials, but the BRICS naval exercises reveal where its strategic sympathies lie. For the West, this is frustrating. For South Africa, it's survival.

The risk? Overplaying its hand. If South Africa tilts too far toward China and Russia, it risks Western sanctions, loss of trade preferences, and investor flight. If it pivots too hard toward the West, it loses credibility with BRICS partners and the broader Global South. Ramaphosa is trying to thread the needle, but the needle's eye is getting narrower.

**The Bottom Line**

South Africa in November 2025 is a country holding its breath. The GNU coalition is intact—for now—but it's fragile, fractious, and one budget crisis away from implosion. Load shedding has improved, but Eskom remains a basket case, and the next power crisis is a matter of "when," not "if." The economy is stagnating, unemployment is crushing a generation, and the rand is one bad headline away from another nosedive. Internationally, South Africa is trying to be all things to all people: a G20 host, a BRICS partner, a non-aligned power broker. It's an impossible balancing act.

What to watch? Ramaphosa's political survival. If he's pushed out or steps down, the GNU could unravel, triggering snap elections and potential ANC-DA divorce. Also watch Eskom—any return to sustained load shedding will crater business confidence and reignite public fury. Finally, keep an eye on South Africa's G20 summit performance. If it successfully mediates between the West and the Global South, it boosts Ramaphosa's standing. If it descends into acrimony or reveals South Africa's pro-BRICS tilt too blatantly, the backlash will be swift.

South Africa has enormous potential, but potential doesn't pay the bills. The clock is ticking.`

const ISSUES = [
  "The GNU Coalition—Can This Marriage Survive?",
  "Load Shedding—Is the Power Crisis Really Over?",
  "The Economy—Stagnation, Unemployment, and the Rand's Rollercoaster",
  "The International Angle: G20, BRICS, and the Great Power Squeeze"
]

async function insertSouthAfricaSummary() {
  console.log('Inserting South Africa summary...\n')

  try {
    await prisma.locationSummary.upsert({
      where: {
        name_type_category: {
          name: SOUTH_AFRICA.name,
          type: SOUTH_AFRICA.type,
          category: 'all'
        }
      },
      create: {
        name: SOUTH_AFRICA.name,
        type: SOUTH_AFRICA.type,
        country: SOUTH_AFRICA.country,
        lat: SOUTH_AFRICA.lat,
        lng: SOUTH_AFRICA.lng,
        category: 'all',
        summary: SOUTH_AFRICA_SUMMARY,
        issues: JSON.stringify(ISSUES),
        topStories: JSON.stringify([]), // Empty array for now
        storyCount: 0,
        updatedAt: new Date()
      },
      update: {
        summary: SOUTH_AFRICA_SUMMARY,
        issues: JSON.stringify(ISSUES),
        topStories: JSON.stringify([]),
        storyCount: 0,
        updatedAt: new Date()
      }
    })

    console.log('✅ South Africa summary successfully inserted!')
    console.log(`\nSummary length: ${SOUTH_AFRICA_SUMMARY.length} characters`)
    console.log(`Issues: ${ISSUES.length}`)
    console.log('\nPreview:')
    console.log(SOUTH_AFRICA_SUMMARY.substring(0, 500) + '...\n')

  } catch (error) {
    console.error('Failed to insert summary:', error)
    throw error
  }
}

insertSouthAfricaSummary()
  .catch(console.error)
  .finally(() => prisma.$disconnect())
