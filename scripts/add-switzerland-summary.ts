import 'dotenv/config'
import { PrismaClient } from '@prisma/client'

const prisma = new PrismaClient()

async function addSwitzerlandSummary() {
  console.log('Adding Switzerland country summary...\n')

  const summary = `# Switzerland

Right, so here's the thing about Switzerland in November 2025 - this is a country at a genuine crossroads. For centuries, the Swiss model has been built on three pillars: neutrality, prosperity, and exceptionalism. But all three are under unprecedented pressure, and what we're watching unfold is nothing short of an identity crisis for one of Europe's most stable democracies.

President Karin Keller-Sutter announced in August that the United States had imposed 39 percent tariffs on Swiss goods - more than double the rate facing the EU. That's not just an economic shock; it's an existential wake-up call. Switzerland's carefully cultivated neutrality, which the Swiss thought made them special, turned out to offer no protection whatsoever in Trump's world of economic coercion. You can't tariff your way out of geopolitical reality, as it turns out.

And then there's the inheritance tax referendum coming up on November 30th. The Socialist Youth have managed to get a proposal to the ballot that would slap a 50% tax on inheritances over CHF 50 million - specifically to fund climate measures. The polls show 64% opposition, but the very fact this is being debated tells you something profound about generational tensions and wealth inequality in a country that prides itself on consensus politics.

## The Big Issues

### 1. The Death of Neutrality (or Its Painful Transformation)

**What's Actually Happening:**
Switzerland's neutrality - enshrined since 1815 - is being systematically dismantled, referendum by referendum, sanction by sanction. After Russia invaded Ukraine in February 2022, Switzerland initially held firm, citing neutrality. Four days later, they buckled to international pressure and adopted all EU sanctions. Since then, they've dutifully adopted all 16 rounds of EU sanctions against Russia.

Now there's a referendum expected in 2025 to actually enshrine neutrality into the constitution - a desperate attempt by conservatives to preserve what's already slipping away. The SVP (Swiss People's Party), Switzerland's largest party with 27.9% of the vote, is leading the charge to preserve traditional neutrality. But the Trump tariffs have exposed the brutal reality: neutrality offers no exemption from economic warfare.

**Why This Really Matters:**
For ordinary Swiss citizens, this isn't just about foreign policy abstraction. Switzerland's entire economy - banking, pharmaceuticals, precision manufacturing - was built on the assumption that neutrality made them a safe, stable, exceptional partner. That 39% tariff? It hits watch manufacturers in the Jura, pharmaceutical companies in Basel, chocolate makers in Zurich. These aren't multinational corporations who can absorb the hit - these are family businesses that have operated for generations on the Swiss model.

And here's the political consequence: the SVP, already Western Europe's largest radical right party, is weaponizing this. They're framing every sanction, every EU concession, every step away from neutrality as a "submission treaty" - and voters are listening.

**Where This Goes Next:**
The constitutional referendum on neutrality will be the flashpoint. If it passes, Switzerland locks itself into a neutrality doctrine that's increasingly incompatible with Western security architecture. If it fails, the SVP and the far-right gain a powerful grievance narrative heading into the next elections. Either way, Switzerland's traditional consensus politics are under strain. Watch for the SVP to tie neutrality to immigration and EU relations - a toxic cocktail that could reshape Swiss politics for a generation.

### 2. The EU Deal: Access vs. Sovereignty

**What's Actually Happening:**
In December 2024, Switzerland and the EU reached what Commission President Ursula von der Leyen called a "historic" deal. Switzerland gets access to almost all of Horizon Europe (the EU's massive research funding program) starting January 2025. The "third bilateral package" was approved by the Swiss cabinet in June, went through consultation until October, and now parliament is deciding.

The deal's terms tell you everything about the balance of power: Switzerland pledged CHF 130 million per year to the EU cohesion fund (2025-2029), maintains some flexibility on immigration "geared to economic needs," gets a safeguard clause, and secures wage protections. Translation: the Swiss got to keep some face-saving provisions while essentially accepting EU rules.

**Why This Really Matters:**
The main sticking points - "free movement of people" and "protection of Swiss wages" - are code for much deeper anxieties. Switzerland's population has grown rapidly due to EU immigration, and in a country where housing is already eye-wateringly expensive and infrastructure is strained, this isn't abstract. Workers in Basel see their wages undercut by commuters from France and Germany. Zurich residents see rental prices soaring as the city becomes a hub for EU professionals.

But here's the bind: Swiss companies need access to EU markets and EU talent. Geneva's pharmaceutical sector, Zurich's financial services, the country's research universities - all depend on frictionless EU access. The political consequence? A society split between urban professionals who benefit from EU integration and rural communities who see only the downsides.

**Where This Goes Next:**
Parliament could still reject the deal, triggering a referendum. If the SVP frames this as a "submission treaty" and ties it to immigration concerns, they could win. But rejection would isolate Switzerland economically - especially dangerous now that Trump's tariffs have exposed Swiss vulnerability. Most likely scenario: the deal passes parliament but faces a referendum challenge in 2026, becoming a proxy battle for Switzerland's entire European future.

### 3. Wealth, Inequality, and the Inheritance Tax Battle

**What's Actually Happening:**
On November 30, 2025, Swiss voters will decide whether to introduce a federal tax on gifts and inheritances exceeding CHF 50 million, subject to a flat 50% rate. The funds would be earmarked exclusively for "socially equitable measures to combat the climate crisis." Both houses of Parliament - National Council and Council of States - rejected it. The government recommended rejection. Current polling shows 64% opposition.

This referendum, launched by the Socialist Youth, has nonetheless sent shockwaves through Switzerland's super-rich. In a country with no federal inheritance tax, where wealthy foreigners have long sought refuge, and where banking secrecy (though diminished) still matters, this proposal represents a fundamental challenge to the Swiss economic model.

**Why This Really Matters:**
Switzerland's prosperity was built on being a safe haven for capital. No inheritance tax, political stability, neutrality - these weren't just policies, they were the brand. The fact that 35% of Swiss voters currently support a 50% inheritance tax tells you that brand is fraying.

For ordinary Swiss citizens, this is about fairness. They see housing costs soaring, climate impacts mounting, and a generation locked out of homeownership - while billionaires park wealth in Geneva and Zug. The initiative's explicit link between wealth taxation and climate measures is savvy politics: it taps into both economic anxiety and environmental urgency.

The political consequence? Even if this fails (likely), it signals a generational shift. Young Swiss voters are less invested in the traditional Swiss model, more concerned about inequality and climate, and more willing to challenge sacred cows.

**Where This Goes Next:**
The initiative will probably fail - 64% opposition is hard to overcome. But watch the margin. If it's closer than expected, you'll see more aggressive wealth tax proposals in future. If the SVP and right-wing parties barely defeat this, they'll use it to rally their base about "socialism" and "attacking success." Either way, Switzerland's consensus model - where left and right compromise - is giving way to polarization.

## The International Angle

Here's who Switzerland is really entangled with right now:

**United States** - The 39% tariff Trump imposed on Swiss goods is the clearest signal that American exceptionalism no longer recognizes Swiss exceptionalism. Historically, the US valued Switzerland as a neutral intermediary - the "protecting power" that represented American interests in places like Cuba and Iran. But Trump's economic nationalism doesn't care about diplomatic niceties. For Swiss pharmaceutical companies and manufacturers, this is catastrophic - the US is a massive market. Switzerland is scrambling to negotiate, but they have limited leverage. The political impact: it's strengthening the hand of those who argue Switzerland needs EU membership (or at least closer EU alignment) to have any negotiating power with the US.

**European Union** - This relationship has always been complicated - Switzerland is surrounded by EU members but not one itself. The December 2024 deal was meant to stabilize things, but it's revealed how much power the EU has. Switzerland needs EU market access desperately; the EU can take or leave Swiss access. Rory would call this "asymmetric interdependence," and he'd be right. The EU's position: accept our rules on free movement and wages, contribute to our cohesion fund, and we'll give you access. Switzerland is learning that being small, rich, and outside the club doesn't mean you get special treatment. Increasingly, the question isn't "Should Switzerland join the EU?" but "Can Switzerland afford not to?"

**Russia** - Switzerland's adoption of EU sanctions against Russia was a watershed moment - it was the first time since World War II that Switzerland unambiguously took sides in a major conflict. The SVP and neutrality advocates are furious, seeing it as capitulation to Western pressure. But the reality is that Switzerland had no choice - remaining neutral would have made them a sanctions-evasion hub, inviting Western retaliation. The Russian response? Freezing Swiss assets and putting Switzerland on the "unfriendly countries" list. Switzerland lost both neutrality credibility and Russian goodwill, gaining only Western approval (which, as the Trump tariffs showed, is worth precisely nothing). This is what a failed geopolitical strategy looks like.

## Bottom Line

Switzerland is facing the end of its post-war model. Neutrality doesn't protect you from economic coercion. Wealth and stability don't immunize you from generational tensions. And being small and exceptional doesn't mean you get special treatment from either the EU or the US.

The November 30 referendum on inheritance tax is symbolic of a deeper question: What does Switzerland stand for if the old model is dead? Watch how close that vote is. Watch the SVP's rhetoric as they prepare for the next elections. And watch how parliament handles the EU deal.

Switzerland isn't in crisis yet - it's still rich, stable, and democratic. But the contradictions are mounting. You can't be neutral and take sides. You can't be a wealthy haven and ignore inequality. You can't be outside the EU and expect EU benefits. Something has to give.

My read? Switzerland is headed for a decade of turbulent, polarized politics that would shock anyone who remembers the Switzerland of old. The consensus is breaking. The question is whether Swiss democracy can adapt - or whether the SVP and far-right forces will exploit the chaos to fundamentally reshape the country.`

  const issues = [
    "The Death of Neutrality (or Its Painful Transformation)",
    "The EU Deal: Access vs. Sovereignty",
    "Wealth, Inequality, and the Inheritance Tax Battle"
  ]

  const topStories = [
    {
      title: "Trump's Tariffs Threaten the End of Swiss Economic Neutrality",
      source: "Foreign Policy",
      link: "https://foreignpolicy.com/2025/11/11/switzerland-trump-tariffs-economic-neutrality/",
      pubDate: new Date('2025-11-11').toISOString()
    },
    {
      title: "Switzerland and EU reach historic deal on future bilateral relations",
      source: "SWI swissinfo.ch",
      link: "https://www.swissinfo.ch/eng/swiss-politics/negotiations-between-switzerland-and-the-eu-concluded-objectives-achieved/88621356",
      pubDate: new Date('2024-12-20').toISOString()
    },
    {
      title: "November 30 vote: Swiss set to reject new inheritance tax",
      source: "SWI swissinfo.ch",
      link: "https://www.swissinfo.ch/eng/swiss-politics/november-30-vote-swiss-set-to-reject-new-inheritance-tax-and-civic-service-for-all/90215770",
      pubDate: new Date('2025-11-10').toISOString()
    },
    {
      title: "ANALYSIS: Just how neutral is Switzerland in 2025?",
      source: "The Local",
      link: "https://www.thelocal.ch/20250318/analysis-just-how-neutral-is-switzerland-in-2025",
      pubDate: new Date('2025-03-18').toISOString()
    },
    {
      title: "Inheritance tax referendum spooks Swiss super-rich",
      source: "SWI swissinfo.ch",
      link: "https://www.swissinfo.ch/eng/swiss-democracy/inheritance-tax-referendum-spooks-swiss-super-rich/89564077",
      pubDate: new Date('2025-06-15').toISOString()
    },
    {
      title: "Swiss People's Party launches fight against EU 'submission treaty'",
      source: "SWI swissinfo.ch",
      link: "https://www.swissinfo.ch/eng/swiss-politics/svp-launches-fight-against-submission-treaty-at-assembly/88777886",
      pubDate: new Date('2025-04-10').toISOString()
    },
    {
      title: "What lies ahead: the Swiss political landscape in 2025",
      source: "SWI swissinfo.ch",
      link: "https://www.swissinfo.ch/eng/swiss-politics/what-lies-ahead-the-swiss-political-landscape-in-2025/88636709",
      pubDate: new Date('2025-01-05').toISOString()
    },
    {
      title: "Switzerland at a Crossroads: The Gradual Erosion of Neutrality",
      source: "The Diplomatic Affairs",
      link: "https://www.thediplomaticaffairs.com/2025/08/07/switzerland-neutrality/",
      pubDate: new Date('2025-08-07').toISOString()
    },
    {
      title: "Inheritance tax and civic duty: Switzerland's November referendums explained",
      source: "The Local",
      link: "https://www.thelocal.ch/20251110/inheritance-tax-and-civic-duty-switzerlands-november-referendums-explained",
      pubDate: new Date('2025-11-10').toISOString()
    },
    {
      title: "The Swiss Federal Inheritance Tax Initiative: Key Considerations Ahead of November 30 Referendum",
      source: "Altenburger",
      link: "https://www.altenburger.ch/blog/the-swiss-federal-inheritance-tax-initiative-key-considerations-ahead-of-the-referendum-on-30-november-2025",
      pubDate: new Date('2025-10-15').toISOString()
    }
  ]

  const tooltip = "Neutrality crisis, Trump tariffs, EU deal, wealth tax vote"

  try {
    const result = await prisma.locationSummary.upsert({
      where: {
        name_type_category: {
          name: 'Switzerland',
          type: 'country',
          category: 'all'
        }
      },
      create: {
        name: 'Switzerland',
        type: 'country',
        country: 'Switzerland',
        lat: 46.8182,
        lng: 8.2275,
        category: 'all',
        summary,
        issues: JSON.stringify(issues),
        topStories: JSON.stringify(topStories),
        storyCount: topStories.length,
        updatedAt: new Date(),
        createdAt: new Date()
      },
      update: {
        summary,
        issues: JSON.stringify(issues),
        topStories: JSON.stringify(topStories),
        storyCount: topStories.length,
        updatedAt: new Date()
      }
    })

    console.log('âœ… Switzerland summary added successfully!')
    console.log(`   - Name: ${result.name}`)
    console.log(`   - Type: ${result.type}`)
    console.log(`   - Category: ${result.category}`)
    console.log(`   - Summary length: ${result.summary.length} characters`)
    console.log(`   - Issues: ${issues.length}`)
    console.log(`   - Top stories: ${topStories.length}`)
    console.log(`   - Coordinates: ${result.lat}, ${result.lng}`)
    console.log(`\nðŸ“ Tooltip text (${tooltip.length} chars): "${tooltip}"`)
    console.log('\nâš ï¸  Next step: Update MapViewLocations.tsx with the tooltip')

  } catch (error) {
    console.error('âŒ Error adding Switzerland summary:', error)
    throw error
  }
}

addSwitzerlandSummary()
  .catch(console.error)
  .finally(() => prisma.$disconnect())
