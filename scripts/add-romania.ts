import 'dotenv/config'
import { PrismaClient } from '@prisma/client'

const prisma = new PrismaClient()

const ROMANIA_SUMMARY = {
  name: 'Romania',
  type: 'country',
  lat: 45.9432,
  lng: 24.9668,
  country: 'Romania',
  summary: `Romania just dodged a democratic bullet—barely. In May 2025, pro-EU centrist Nicusor Dan defeated hard-right nationalist George Simion 54%-46% in a presidential runoff that was supposed to happen six months earlier. Why the delay? Because in November 2024, Romania's Constitutional Court took the unprecedented step of annulling the first-round presidential election after far-right candidate Calin Georgescu shocked everyone by winning—amid credible allegations of Russian interference. The court ordered a complete do-over, pushing the election to May 2025. Dan's victory was welcomed with relief in Brussels and Kyiv, but don't mistake this for stability. Euro-skeptic far-right parties now hold 113 seats in Romania's Chamber of Deputies, nearly matching the ruling coalition's 135. The Alliance for the Union of Romanians (AUR), led by Simion, has gone from fringe protest movement to kingmaker, riding voter fury over corruption, inflation, and Ukraine fatigue. Meanwhile, Romania is trying to play a delicate game: staunchly supporting Ukraine while managing its own defense procurement scandals, maintaining EU alignment while grappling with deep public skepticism about Brussels, and positioning itself as Eastern Europe's democratic anchor while its institutions show signs of serious strain. This is Romania in November 2025: a country that survived an election crisis but hasn't resolved the deeper fractures that caused it.

**The Big Issue 1: The Annulled Election and Far-Right Resurgence**

Let's start with the chaos. On November 24, 2024, Calin Georgescu—a far-right, pro-Russia independent candidate who had barely registered in polls—won the first round of Romania's presidential election. It was a political earthquake. Georgescu, who had praised Vladimir Putin and questioned Romania's NATO membership, secured enough votes to advance to the December 8 runoff. Then, on December 6—just two days before the runoff—Romania's Constitutional Court dropped a bombshell: it annulled the entire election, citing evidence of "manipulation of public opinion" by a "foreign state." The court didn't name Russia explicitly, but everyone knew. Intelligence reports revealed coordinated TikTok campaigns, bot networks amplifying Georgescu's anti-establishment messaging, and suspicious funding flows. The annulment was unprecedented in Romanian democratic history and deeply controversial. Critics argued it set a dangerous precedent—what's to stop future courts from canceling elections they don't like? Supporters insisted it was necessary to protect democracy from foreign interference.

The do-over election was scheduled for May 2025. This time, the far-right vote consolidated around George Simion, leader of the Alliance for the Union of Romanians (AUR). Simion is more polished than Georgescu—less overtly pro-Russia, more tactically nationalist. He campaigned on unifying Romania with Moldova, cracking down on corruption (while conveniently ignoring AUR's own ethical lapses), and rolling back what he called Romania's "submissive" relationship with the EU. In the first round on May 4, Simion topped the field. In the May 18 runoff, he faced Nicusor Dan, Bucharest's popular mayor and a centrist technocrat backed by pro-European parties. Dan won 54%-46%, but the margin was narrower than EU officials had hoped. Here's the critical point: the far-right didn't go away. AUR and allied parties now control 113 parliamentary seats. They're blocking reforms, forcing the ruling coalition to negotiate on key legislation, and positioning themselves for the next electoral cycle. Simon has positioned AUR as the voice of "forgotten Romania"—rural areas, pensioners, workers left behind by globalization. And it's working.

**The Big Issue 2: Corruption and the Defense Procurement Scandal**

Romania has been fighting corruption for decades, with mixed results. The National Anticorruption Directorate (DNA) achieved some high-profile prosecutions in the 2010s, but political interference has weakened it in recent years. Now, in 2025, a new scandal has emerged that perfectly encapsulates Romania's corruption problem: a convoluted arms-trafficking scheme tied to Ukraine aid. Here's what happened: Romanian authorities arrested a former senator in early 2025 for allegedly attempting to bribe the Defense Minister with 1 million euros. The goal? To facilitate a fraudulent arms deal that would purchase Russian-type artillery shells from Kazakhstan, import them to Romania, refurbish and relabel them as "Romanian shells," and then sell them to Ukraine via a Bulgarian intermediary. The scheme was designed to fraudulently obtain EU funds from the Rearm Europe program, a 27-nation initiative to boost weapons manufacturing across the bloc.

This wasn't just about one corrupt politician—it exposed systemic rot in Romania's military procurement. A Balkan Investigative Reporting Network (BIRN) investigation uncovered troubling patterns: local military units funneling public contracts to companies with questionable qualifications, ties to military personnel, or previous criminal investigations. Since the Ukraine war began, millions in public funds have gone to suppliers who shouldn't have qualified for contracts. The Romanian government insists it's cracking down, but public trust is cratering. Romanians are watching politicians promise solidarity with Ukraine while skimming off aid meant for Kyiv. It's a gift to the far-right. Simion and AUR have weaponized the scandal, arguing that Romania's pro-EU elite are corrupt hypocrites enriching themselves while ordinary Romanians struggle with inflation and energy costs. The tragedy is that Romania actually has been a critical supporter of Ukraine—hosting NATO troops, accepting refugees, and providing military aid. But the corruption scandal undermines that narrative.

**The Big Issue 3: EU Relations and Ukraine Fatigue**

Romania joined the EU in 2007, and for years, EU membership was sacrosanct in Romanian politics—supported by over 70% of the population. That consensus is fracturing. In November 2025, polling suggests EU support has dropped to around 60%, with younger voters and rural populations increasingly skeptical. The far-right has tapped into this. AUR doesn't call for outright EU exit—Romanians aren't that Eurosceptic—but pushes "sovereignty" rhetoric: Brussels shouldn't dictate Romania's migration policy, energy choices, or judicial reforms. Simion frames the EU as an elitist project that benefits Western Europe at Eastern Europe's expense. He's not entirely wrong. Romania is one of the EU's poorest members, with a GDP per capita roughly half the EU average. Millions of young, educated Romanians have emigrated West for better wages. Rural areas are depopulating. Infrastructure is crumbling. And EU funds meant to close these gaps have been slow, bureaucratic, and sometimes diverted by corrupt local officials.

Then there's Ukraine. Romania has been a frontline state in supporting Ukraine since February 2022. It shares a 650 km border with Ukraine, hosts NATO's largest Eastern European deployment, and has accepted hundreds of thousands of Ukrainian refugees. But by late 2025, fatigue is setting in. Romanians are frustrated by rising energy costs (partly blamed on EU sanctions on Russian energy), inflation running above 6%, and the sense that Western Europe isn't sharing the burden equally. Georgescu's platform in 2024 explicitly called for ending Romanian support for Ukraine if elected. Simion was more cautious—he backed Ukraine support publicly but hinted at "reassessing priorities" if elected. The ruling coalition, led by Prime Minister Marcel Ciolacu's Social Democrats and the National Liberal Party, remains staunchly pro-Ukraine and pro-EU. But they're governing on thin margins, vulnerable to populist backlash. If the economy worsens, or if a major incident—say, Russian missiles landing on Romanian soil—happens without strong NATO response, public opinion could flip fast.

**The International Angle**

Brussels and Washington were terrified by Romania's November 2024 election crisis. A Georgescu presidency would have been a nightmare: a pro-Russia leader inside NATO and the EU, potentially blocking sanctions, vetoing aid to Ukraine, and cozying up to Viktor Orban's Hungary. Nicusor Dan's May 2025 victory averted that disaster, but the EU knows it was close. Romanian Foreign Minister Luminita Odobescu has been working overtime to reassure allies, attending NATO summits, backing Ukraine aid packages, and emphasizing Romania's strategic importance. Romania wants to be seen as Eastern Europe's reliable partner—not another Hungary. But that reliability comes at a domestic political cost. Every time the government backs EU sanctions or increases defense spending, AUR gains votes.

On Ukraine specifically, Romania is in a bind. It genuinely supports Ukrainian sovereignty and fears Russian aggression on its doorstep. But it also can't afford to alienate voters exhausted by the economic pain of prolonged conflict. Romanian officials have quietly pushed the EU to provide more financial support to frontline states like Romania, Poland, and the Baltics—arguing that if Brussels wants Eastern Europe's continued backing for Ukraine, it needs to share costs more equitably. So far, the response has been lukewarm. Watch Romania's relationship with Moldova closely. Simion campaigned on reunification—absorbing Moldova back into Romania, reversing the 1940 Soviet annexation. It's nationalist red meat, but it's also dangerous. Moldova is fragile, with a pro-EU government in Chisinau under constant Russian pressure. If Romania's politics shift further right, it could destabilize Moldova and complicate EU enlargement plans.

**The Bottom Line**

Romania in November 2025 is a country that just barely held the line for democracy, but the battle isn't over. Nicusor Dan's presidency gives pro-European forces breathing room, but the far-right surge isn't reversing—it's consolidating. AUR controls over a third of parliament, and unless the ruling coalition delivers on corruption reform, economic growth, and tangible improvements to ordinary Romanians' lives, Simion will be back in 2029 with an even stronger hand. Watch three things: First, whether Romania can prosecute the defense procurement scandal credibly—if it buries the investigation or lets elites off easy, public trust will collapse further. Second, whether the EU steps up with real financial support for Romania's Ukraine burden—rhetoric isn't enough anymore. Third, whether Nicusor Dan can use the presidency to push genuine reform—if he becomes another aloof technocrat disconnected from voters' economic pain, the far-right will feast. Romania is strategically vital: NATO's eastern flank, Ukraine's neighbor, a potential anchor for EU enlargement into Moldova and the Western Balkans. But it's politically fragile, economically vulnerable, and one election cycle away from a very different trajectory. Europe can't take Romania for granted anymore.`,
  issues: JSON.stringify([
    'Annulled Election and Far-Right Resurgence',
    'Corruption and Defense Procurement Scandal',
    'EU Relations and Ukraine Fatigue'
  ]),
  topStories: JSON.stringify([
    {
      title: 'Pro-EU Nicusor Dan defeats hard-right rival in key Romania election',
      source: 'Al Jazeera',
      link: 'https://www.aljazeera.com/news/2025/5/18/pro-eu-nicusor-dan-on-course-to-beat-hard-right-rival-in-romania-election',
      pubDate: new Date('2025-05-18').toISOString()
    },
    {
      title: 'Far-right Simion tops first round of Romania\'s presidential election',
      source: 'Al Jazeera',
      link: 'https://www.aljazeera.com/news/2025/5/4/romania-votes-in-crucial-presidential-election-rerun',
      pubDate: new Date('2025-05-04').toISOString()
    },
    {
      title: 'Romanian far-right AUR party leads protests against annulled presidential election',
      source: 'Euronews',
      link: 'https://www.euronews.com/my-europe/2025/01/12/tens-of-thousands-of-romanians-protest-against-annulled-presidential-race',
      pubDate: new Date('2025-01-12').toISOString()
    },
    {
      title: 'Romania arrests six over alleged Russia-linked coup plot',
      source: 'Al Jazeera',
      link: 'https://www.aljazeera.com/news/2025/3/6/romania-arrests-six-over-alleged-russia-linked-coup-plot',
      pubDate: new Date('2025-03-06').toISOString()
    },
    {
      title: 'Suspect arrested in Romania for attempt to bribe minister over Ukraine arms purchase',
      source: 'RFE/RL',
      link: 'https://www.rferl.org/a/suspect-arrested-romania-bribe-ukraine-arms-purchase/33587466.html',
      pubDate: new Date('2025-02-15').toISOString()
    },
    {
      title: 'Fog of War: Battling a Lack of Transparency in Romanian Military Contracts',
      source: 'Balkan Insight',
      link: 'https://balkaninsight.com/2025/02/04/fog-of-war-battling-a-lack-of-transparency-in-romanian-military-contracts/',
      pubDate: new Date('2025-02-04').toISOString()
    }
  ]),
  storyCount: 22
}

async function addRomania() {
  console.log('Adding Romania to database...\n')

  try {
    const result = await prisma.locationSummary.upsert({
      where: {
        name_type_category: {
          name: ROMANIA_SUMMARY.name,
          type: ROMANIA_SUMMARY.type,
          category: 'all'
        }
      },
      create: {
        name: ROMANIA_SUMMARY.name,
        type: ROMANIA_SUMMARY.type,
        country: ROMANIA_SUMMARY.country,
        lat: ROMANIA_SUMMARY.lat,
        lng: ROMANIA_SUMMARY.lng,
        category: 'all',
        summary: ROMANIA_SUMMARY.summary,
        issues: ROMANIA_SUMMARY.issues,
        topStories: ROMANIA_SUMMARY.topStories,
        storyCount: ROMANIA_SUMMARY.storyCount,
        updatedAt: new Date()
      },
      update: {
        summary: ROMANIA_SUMMARY.summary,
        issues: ROMANIA_SUMMARY.issues,
        topStories: ROMANIA_SUMMARY.topStories,
        storyCount: ROMANIA_SUMMARY.storyCount,
        updatedAt: new Date()
      }
    })

    console.log('✅ Romania added/updated successfully')
    console.log('   ID:', result.id)
    console.log('   Name:', result.name)
    console.log('   Location:', `${result.lat}, ${result.lng}`)
    console.log('   Issues:', JSON.parse(result.issues).length)
    console.log('   Stories:', JSON.parse(result.topStories).length)
    console.log()
  } catch (error) {
    console.error('❌ Error processing Romania:', error)
    throw error
  }
}

addRomania()
  .catch(console.error)
  .finally(() => prisma.$disconnect())
