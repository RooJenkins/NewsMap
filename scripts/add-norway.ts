import 'dotenv/config'
import { PrismaClient } from '@prisma/client'

const prisma = new PrismaClient()

const NORWAY_SUMMARY = {
  name: 'Norway',
  type: 'country',
  lat: 60.4720,
  lng: 8.4689,
  country: 'Norway',
  summary: `Jens Stoltenberg is back, and Norwegian politics has never looked so dramatic. The former NATO Secretary-General—who once led Norway as Prime Minister from 2005 to 2013—returned to domestic politics in spectacular fashion in January 2025, accepting Jonas Gahr Støre's offer to become Finance Minister. Within days, the "Stoltenback" effect was undeniable: Labour surged 10 points in the polls, turning what looked like certain electoral defeat into a stunning September 2025 victory. The red-green bloc secured 88 seats, allowing Støre to continue as Prime Minister, this time with Stoltenberg as his political heavyweight. But the euphoria masks deeper tensions. Norway is navigating a perfect storm: Russia is weaponizing the Arctic, with nuclear-armed submarines prowling Norwegian waters and hybrid warfare targeting critical infrastructure. The $1.9 trillion oil wealth fund—now generating more income than oil and gas production itself—faces existential questions about climate responsibility and economic dependency. And NATO just held emergency Arctic security talks on November 12, 2025, with Norwegian Defense Minister warning that the risk of conflict in the High North has never been higher. This is Norway in November 2025: rich, anxious, and positioned on the frontline of a new Cold War.

**The Big Issue 1: Arctic Security Crisis and Russian Aggression**

Let's not mince words: Norway is terrified of Russia. And with good reason. On November 12, 2025, NATO convened Defense Ministers from Norway, Denmark, and Iceland's Foreign Minister in Brussels for emergency talks on Arctic security. The agenda was stark: Russia's increased military presence, hybrid warfare attacks, and the strategic reality that Russia has positioned its nuclear deterrent forces in the Arctic—aimed directly at the United States and NATO. Norwegian officials describe it as "panic" in Oslo, though publicly they maintain Nordic stoicism. The High North—Norway's Arctic territories including Svalbard—has become ground zero for this new confrontation. Russian submarines equipped with nuclear weapons regularly patrol Norwegian waters, part of Moscow's strategy to compensate for conventional military losses in Ukraine by projecting strategic power through its Arctic arsenal.

Here's what's changed: Russia is increasingly relying on hybrid warfare tactics. We're talking cyber attacks on Norwegian critical infrastructure, GPS jamming near Finnmark (Norway's northernmost county bordering Russia), and suspected sabotage attempts on undersea cables. In October 2025, NATO officials briefed that Russia had conducted "probing operations" testing Norwegian response times and defense capabilities. The Norwegian government has responded by launching a long-term defense plan committing NOK 600 billion (€50.9 billion) over the next decade—the largest defense investment in Norwegian history. The focus: operational capability along Norway's 83,281 km coastline, enhanced situational awareness using space-based surveillance (including commercial satellites), and deeper integration with NATO's Arctic defense architecture. But here's the uncomfortable truth: Norway can't defend itself alone. It's utterly dependent on NATO, particularly the United States, for any credible deterrence against Russia. That dependency makes Norway vulnerable to American political instability and shifts in Washington's commitment to European defense.

**The Big Issue 2: The Oil Wealth Fund's Existential Dilemma**

Norway's sovereign wealth fund is now worth $1.9 trillion—or roughly $350,000 per Norwegian citizen. It's the world's largest sovereign wealth fund, controlling 1.5% of all listed companies globally, invested across 70 countries and almost 9,000 companies. And here's the kicker: the fund now generates more income for Norway's 5.6 million people than the country's oil and gas production. Let that sink in. Norway has become so wealthy from petroleum that it's shifted from extracting fossil fuels to living off investment returns from that extraction. In Q3 2025, the fund returned 7.7% on equity investments, 1.4% on fixed income, and is on track to exceed $2 trillion by early 2026. But this extraordinary wealth has created three interlocking crises that dominated Norwegian political debate throughout November 2025.

First, the climate paradox: Norway positions itself as a climate leader—the fund's 2025 Climate Action Plan targets net-zero emissions for all portfolio companies by 2050, requires climate risk disclosure, and threatens exclusion for firms mismanaging climate transition. Yet Norway continues extracting oil and gas, arguing that "the world needs Norwegian energy" as a transition fuel and that cutting production would simply shift extraction elsewhere. Environmental activists call it rank hypocrisy; the government insists it's pragmatic climate policy. Second, economic dependency: economists warn that Norway's economy has become dangerously reliant on the fund's returns. Domestic industries are becoming less innovative and dynamic because why bother competing when you've got a trillion-dollar cushion? The fund's spending rule—the government can use up to 3% of the fund's value annually—is under pressure, with calls to boost spending to combat inflation and fund defense buildups. But breaching the 3% rule risks depleting the fund and transferring less wealth to future generations. Third, geopolitical risk: with $1.9 trillion invested globally, Norway is exposed to every major geopolitical shock. A U.S.-China conflict, European recession, or global market crash would devastate Norwegian wealth. It's a vulnerability that keeps Stoltenberg, as Finance Minister, awake at night.

**The Big Issue 3: Stoltenberg's Return and the Politics of Coalition Building**

When Jens Stoltenberg returned to Norwegian politics in January 2025, taking up the role of Finance Minister, it was supposed to be a stabilizing move. Støre's minority Labour government—which had governed alone since January 2025 after the Centre Party quit the coalition—was hemorrhaging support. The far-right Progress Party was surging in polls on anti-immigration sentiment. Enter Stoltenberg: the elder statesman, fresh from a decade leading NATO through its most consequential period since the Cold War. His credibility was instant. Labour gained 10 points within a week, and by September's election, the "Jens effect" had delivered victory. The red-green bloc—Labour, Socialist Left, Centre Party, and Red Party—secured 88 seats against 81 for the right-wing opposition. Labour itself captured 28% of votes, making Støre's continued premiership possible.

But here's where it gets complicated: the Progress Party—Norway's populist, anti-immigration, Euroskeptic party—recorded their best-ever result, becoming the second-largest party in the Storting (parliament). They capitalized on voter anxiety over immigration, healthcare waiting times, rising inequality, and the wealth tax that's driving rich Norwegians to move abroad. The election revealed a deeply divided Norway: urban, educated, climate-conscious voters backing Labour and the Greens; rural, working-class, and immigration-skeptical voters backing Progress. Støre now governs with the support of four left-wing parties, a fractious coalition where the Socialist Left and Red Party demand wealth redistribution and tougher climate action, while the Centre Party wants rural subsidies and skepticism toward EU integration. Stoltenberg's job, as Finance Minister, is to hold this together while managing the oil fund, funding a massive defense buildup, and navigating inflation that's running at 3%—higher than the ECB's 2% target. The wealth tax debate is particularly toxic: high earners are leaving Norway in record numbers, eroding the tax base, yet scrapping the tax would enrage the left-wing parties propping up the government. Watch this space: if Stoltenberg can't square this circle, the coalition will collapse.

**The International Angle**

Norway is leveraging its Arctic position and NATO membership to punch above its weight internationally. At the November 12 NATO meeting, Norwegian officials pushed for expanded space-based Arctic surveillance, arguing that commercial satellites can provide real-time intelligence on Russian military movements and hybrid threats. This is strategic: Norway wants NATO to see Arctic defense as central to European security, not a peripheral concern. On Ukraine, Norway has been quietly indispensable—providing military aid, training Ukrainian forces, and backing sanctions even when it's economically painful. Norwegian officials see Ukraine's defense as existential: if Russia wins in Ukraine, Norway could be next.

On climate, Norway walks a tightrope. At COP30 in Belém, Brazil (November 10-21, 2025), Norway pushed the EU toward ambitious 2035 emissions targets while continuing to extract North Sea oil. Norwegian negotiators argue this isn't contradictory—that responsible European production with carbon capture is better than importing oil from authoritarian regimes with worse environmental standards. Critics call it greenwashing; Norway calls it realism. The deeper point: Norway's foreign policy is about maintaining relevance. It's a small, rich country that can't defend itself alone, depends on NATO and the EU for security and market access, and uses climate diplomacy and Ukraine support to stay in the room where decisions are made. With Stoltenberg—a towering figure in European security circles—as Finance Minister, Norway's international clout has never been higher. But that clout rests on unstable foundations: American commitment to NATO, European unity on Russia sanctions, and Norway's own internal political cohesion.

**The Bottom Line**

Norway in November 2025 is a country confronting hard truths. The Arctic is militarizing. Russia is aggressive and unpredictable. The oil wealth that made Norway rich is now a political albatross, creating dependency, moral contradictions, and vulnerability to global shocks. Stoltenberg's return has bought Støre time, but the coalition is fragile and the Progress Party is waiting for its moment. Watch three things: First, whether Norway can sustain its defense buildup without breaching the oil fund's 3% spending rule or raising unpopular taxes. Second, whether hybrid warfare incidents escalate—a serious Russian provocation could force Norway to invoke NATO's Article 5 for the first time. Third, whether Stoltenberg's political magic holds—if inflation doesn't fall, the wealth tax exodus continues, and healthcare waiting times worsen, the coalition could fracture. Norway's wealth gives it options. But in an unstable world, even $1.9 trillion doesn't guarantee security.`,
  issues: JSON.stringify([
    'Arctic Security Crisis and Russian Aggression',
    'The Oil Wealth Fund\'s Existential Dilemma',
    'Stoltenberg\'s Return and Coalition Politics'
  ]),
  topStories: JSON.stringify([
    {
      title: 'NATO discusses Arctic space security with Norway, Denmark, Iceland',
      source: 'NATO',
      link: 'https://www.nato.int/cps/en/natohq/news_238915.htm',
      pubDate: new Date('2025-11-12').toISOString()
    },
    {
      title: 'Norway\'s red-green bloc wins parliamentary majority in September election',
      source: 'Al Jazeera',
      link: 'https://www.aljazeera.com/news/2025/9/8/we-did-it-norways-ruling-pm-stoere-claims-victory-in-general-elections',
      pubDate: new Date('2025-09-08').toISOString()
    },
    {
      title: 'Jens Stoltenberg returns as Norway Finance Minister, Labour surges in polls',
      source: 'Life in Norway',
      link: 'https://www.lifeinnorway.net/norway-election-2025/',
      pubDate: new Date('2025-01-15').toISOString()
    },
    {
      title: 'Norway\'s $2 trillion wealth fund expands climate-focused engagements',
      source: 'ESG Today',
      link: 'https://www.esgtoday.com/norways-2-trillion-wealth-fund-to-expand-climate-focused-engagements-with-portfolio-companies/',
      pubDate: new Date('2025-10-29').toISOString()
    },
    {
      title: 'Norway launches NOK 600bn defense plan amid Russian Arctic buildup',
      source: 'High North News',
      link: 'https://www.highnorthnews.com/en/norway-under-pressure-new-strategy-high-north-2025',
      pubDate: new Date('2025-09-15').toISOString()
    },
    {
      title: 'Progress Party achieves best-ever result, becomes second largest in Storting',
      source: 'Political Compass',
      link: 'https://www.politicalcompass.org/norway2025',
      pubDate: new Date('2025-09-09').toISOString()
    }
  ]),
  storyCount: 18
}

async function addNorway() {
  console.log('Adding Norway to database...\n')

  try {
    const result = await prisma.locationSummary.upsert({
      where: {
        name_type_category: {
          name: NORWAY_SUMMARY.name,
          type: NORWAY_SUMMARY.type,
          category: 'all'
        }
      },
      create: {
        name: NORWAY_SUMMARY.name,
        type: NORWAY_SUMMARY.type,
        country: NORWAY_SUMMARY.country,
        lat: NORWAY_SUMMARY.lat,
        lng: NORWAY_SUMMARY.lng,
        category: 'all',
        summary: NORWAY_SUMMARY.summary,
        issues: NORWAY_SUMMARY.issues,
        topStories: NORWAY_SUMMARY.topStories,
        storyCount: NORWAY_SUMMARY.storyCount,
        updatedAt: new Date()
      },
      update: {
        summary: NORWAY_SUMMARY.summary,
        issues: NORWAY_SUMMARY.issues,
        topStories: NORWAY_SUMMARY.topStories,
        storyCount: NORWAY_SUMMARY.storyCount,
        updatedAt: new Date()
      }
    })

    console.log('✅ Norway added/updated successfully')
    console.log('   ID:', result.id)
    console.log('   Name:', result.name)
    console.log('   Location:', `${result.lat}, ${result.lng}`)
    console.log('   Issues:', JSON.parse(result.issues).length)
    console.log('   Stories:', JSON.parse(result.topStories).length)
    console.log()
  } catch (error) {
    console.error('❌ Error processing Norway:', error)
    throw error
  }
}

addNorway()
  .catch(console.error)
  .finally(() => prisma.$disconnect())
