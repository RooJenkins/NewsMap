import 'dotenv/config'
import { PrismaClient } from '@prisma/client'

const prisma = new PrismaClient()

const PARAGUAY_SUMMARY = {
  name: 'Paraguay',
  type: 'country',
  lat: -23.4425,
  lng: -58.4438,
  country: 'Paraguay',
  summary: `Paraguay is confronting its most severe institutional crisis since the democratic transition of 1989. In February 2025, thousands filled the streets of Asunción demanding an end to what protesters described as "mafia-style control" over the judiciary, following explosive WhatsApp revelations exposing deep-rooted corruption networks linking senior legislators, judges, and prosecutors. President Santiago Peña—who took office in August 2023 promising to tackle corruption and maintain Taiwan ties—faces the uncomfortable reality that his Colorado Party has governed Paraguay for all but five years since 1947, and institutional rot runs deep. Yet paradoxically, Paraguay's economy is booming: GDP surged 5.9% in the first half of 2025, inflation is falling toward the 3.5% target, and the IMF just completed its sixth Policy Coordination Instrument review in November 2025, praising fiscal consolidation efforts. Meanwhile, Paraguay remains the only South American nation maintaining diplomatic relations with Taiwan, a stance that brings military hardware and economic investment but also geopolitical vulnerability. This is Paraguay in November 2025: economically dynamic, institutionally compromised, and diplomatically isolated—a small landlocked country punching above its weight while struggling with ghosts of corruption past.

**The Big Issue 1: Corruption Crisis and WhatsApp Revelations**

Let's start with the bombshell that's defined 2025 Paraguayan politics: in February, leaked WhatsApp messages exposed a sprawling network of bribery and influence-peddling involving senior figures across government, judiciary, and prosecution services. We're talking about judges taking bribes to fix cases, prosecutors colluding with organized crime networks, and legislators trading influence for cash payments. The scale shocked even cynical Paraguayans accustomed to corruption. On February 11, 2025, protesters flooded central Asunción—thousands marching under the banner "Basta de Corrupción" (Enough Corruption), demanding institutional reform and the removal of compromised officials. The demonstrations represented Paraguay's largest anti-corruption mobilization since the 2017 protests that burned down the Congress building after lawmakers tried to allow presidential re-election.

Here's why this matters: Paraguay ranks among the most corrupt countries in Latin America, and new evidence from a November 2025 study identified Paraguay (alongside Brazil and Bolivia) as facing the highest annual corruption risk in the region. The State Department notes that although Paraguay passed anti-money laundering and terrorism financing laws in 2019, prosecutions remain "rare" due to entrenched corruption in political and judicial sectors. President Peña responded to the February crisis by launching a "National Anti-Corruption Strategy" containing 44 "measurable, quantifiable" actions—but critics dismiss it as window dressing from a government whose Colorado Party has been synonymous with patronage politics for seven decades. The uncomfortable truth: Paraguay's democratic institutions are deeply compromised. The judiciary lacks independence, prosecutors face political pressure, and organized crime groups—particularly drug trafficking networks—have infiltrated state structures. When protesters demand "institutional reform," they're not just talking about firing corrupt officials; they're calling for fundamental reconstruction of Paraguay's governance architecture.

**The Big Issue 2: Drug Trafficking and Organized Crime Penetration**

Paraguay has become a critical node in South American cocaine trafficking routes, and organized crime's penetration of state institutions represents an existential threat to democracy. Here are the facts: Paraguay sits between Bolivia (the world's third-largest cocaine producer) and Brazil (Latin America's largest cocaine market), making it a natural transit country. The Tri-Border Area—where Paraguay meets Argentina and Brazil—has long been a smuggling hub, but what's changed is the scale and sophistication of operations. Brazilian criminal organizations, particularly the Primeiro Comando da Capital (PCC) and Comando Vermelho (CV), now use Paraguay as a logistics base, storing cocaine in rural areas before moving it through Brazil's ports or north toward Europe via the Caribbean.

But here's the deeper problem: these organizations don't just transit through Paraguay; they've corrupted Paraguayan officials at every level. Prosecutors, police, border guards, and local politicians receive payoffs to facilitate smuggling or simply look the other way. The February 2025 WhatsApp revelations exposed direct links between high-ranking prosecutors and drug trafficking networks—cases where prosecutors tipped off traffickers about investigations or sabotaged prosecutions in exchange for payments. Paraguay's institutional weakness makes it vulnerable: weak law enforcement, porous borders, limited state presence in rural areas, and a culture of impunity where even exposed corruption rarely leads to serious consequences. The Peña government has accepted security assistance from both the United States and Taiwan—Taiwan donated four Bell UH-1H helicopters in August 2025 for counter-narcotics operations, while U.S. agencies provide training and intelligence—but hardware alone won't fix institutional corruption. Until Paraguay can prosecute corrupt officials and dismantle political-criminal networks, organized crime will continue operating with near-impunity.

**The Big Issue 3: Taiwan Gamble and Diplomatic Isolation**

Paraguay is the last South American domino still standing with Taiwan, and that position is increasingly precarious. Every other South American nation recognizes the People's Republic of China. Paraguay's Taiwan relationship delivers tangible benefits: Taiwan has provided HUMMWV trucks, helicopters, and other military equipment; Taiwanese investment built infrastructure; and most significantly, Taiwan-based Master Bus is constructing a $30 million electric bus factory that would create 1,200 Paraguayan jobs and supply Mercosur markets. The United States—which views Paraguay as an "important ally" precisely because of Taiwan ties—has rewarded this loyalty with security cooperation and diplomatic support.

But the costs are mounting. Paraguay is shut out of Chinese investment flooding Latin America—Chinese firms are building ports in Peru, railways in Argentina, and 5G networks in Brazil, while Paraguay watches from the sidelines. China is Paraguay's second-largest trading partner (after Brazil), yet the lack of diplomatic relations complicates trade, particularly for agricultural exports. Paraguay's agricultural sector—beef, soybeans, wheat—desperately wants Chinese market access, creating domestic pressure on Peña to switch recognition. During the 2023 presidential campaign, opposition candidate Efraín Alegre explicitly promised to recognize China if elected; Peña won by defending Taiwan ties, but that political consensus is fragile. Watch the 2028 election: if economic conditions deteriorate or Taiwan fails to deliver sufficient investment, a future Paraguayan president could flip. Taiwan is aware of this vulnerability and continually sweetens the deal—hence the electric bus factory announced in 2025—but Paraguay's loyalty has a price, and that price keeps rising. The deeper point: Paraguay's Taiwan stance reflects both principle and pragmatism. Peña's Colorado Party values the relationship for ideological and economic reasons, and the United States provides security benefits for maintaining it. But Paraguay is isolated in South America on this issue, and the longer China's economic influence grows while Paraguay stays outside, the harder this position becomes to sustain.

**The International Angle**

Paraguay's foreign policy is about maximizing benefits from great power competition while navigating regional isolation. On Taiwan, Paraguay leverages its lone-wolf status for maximum concessions—Taiwan knows losing Paraguay would be a devastating symbolic and strategic blow, so it keeps the sweeteners coming. On the United States, Paraguay positions itself as Washington's reliable partner in a region where Chinese and Russian influence is expanding—U.S. security assistance, DEA cooperation, and diplomatic backing follow. The November 2025 IMF review matters here too: by maintaining fiscal discipline and hitting growth targets, Paraguay signals to international investors and financial institutions that it's a stable bet despite corruption challenges. The IMF's positive assessment—praising Paraguay's 5.3% projected GDP growth for 2025 and fiscal consolidation achieving the 1.9% deficit target—gives international credibility.

But regionally, Paraguay is isolated. It's a member of Mercosur (alongside Brazil, Argentina, Uruguay) but often at odds with larger members on trade policy. Paraguay's agricultural exports compete with Argentine and Brazilian products, creating friction. And on Venezuela—where Mercosur suspended Caracas in 2016 for democratic violations—Paraguay took a hard line that pleased Washington but strained relations with left-leaning governments in the region. The bottom line: Paraguay's international strategy is transactional. It trades Taiwan loyalty for investment and U.S. backing, uses IMF credibility to attract foreign capital, and navigates Mercosur tensions by playing the small-country-victim card. It's a high-wire act that's worked so far, but it's vulnerable to external shocks—a Taiwan-China reunification, U.S. political shifts, or regional economic crisis could leave Paraguay exposed.

**The Bottom Line**

Paraguay in November 2025 is a study in contradictions. The economy is growing at 5.9%, inflation is cooling, and the IMF is pleased—but protesters are demanding systemic anti-corruption reform and drug trafficking networks have infiltrated the state. President Peña governs a country with democratic institutions on paper but "mafia-style control" in practice. Taiwan ties deliver investment but guarantee Chinese isolation. Watch three things: First, whether Peña's anti-corruption strategy produces actual prosecutions of senior officials—if the WhatsApp scandal produces no consequences, institutional legitimacy collapses further. Second, whether organized crime violence escalates—if Brazilian gang warfare spills into Paraguay (as it has in parts of the Tri-Border Area), the security situation could deteriorate rapidly. Third, whether Taiwan can maintain Paraguay's loyalty through 2028—if economic conditions worsen or China offers an irresistible deal, a future government could flip, ending Paraguay's diplomatic uniqueness. Paraguay's economic growth gives it breathing room, but corruption, crime, and diplomatic isolation are structural vulnerabilities that no GDP figure can paper over.`,
  issues: JSON.stringify([
    'Corruption Crisis and WhatsApp Revelations',
    'Drug Trafficking and Organized Crime Penetration',
    'Taiwan Gamble and Diplomatic Isolation'
  ]),
  topStories: JSON.stringify([
    {
      title: 'IMF concludes sixth review under Policy Coordination Instrument for Paraguay',
      source: 'IMF',
      link: 'https://www.imf.org/en/News/Articles/2025/11/06/pr25359-paraguay-imf-mission-concludes-visit-for-6th-rev-under-pci-and-4th-rev-under-rsf',
      pubDate: new Date('2025-11-06').toISOString()
    },
    {
      title: 'Paraguay GDP growth hits 5.9% in first half of 2025, services and construction surge',
      source: 'World Bank',
      link: 'https://thedocs.worldbank.org/en/doc/e408a7e21ba62d843bdd90dc37e61b57-0500032021/related/mpo-pry.pdf',
      pubDate: new Date('2025-10-15').toISOString()
    },
    {
      title: 'Taiwan donates four Bell UH-1H helicopters to Paraguay for counter-narcotics operations',
      source: 'Indrastra',
      link: 'https://www.indrastra.com/2025/08/loyal-paraguay-pena-governments.html',
      pubDate: new Date('2025-08-15').toISOString()
    },
    {
      title: 'Thousands protest in Asunción demanding judicial reform after WhatsApp corruption scandal',
      source: 'Civicus Monitor',
      link: 'https://monitor.civicus.org/explore/president-enacts-controversial-law-restricting-civil-society/',
      pubDate: new Date('2025-02-11').toISOString()
    },
    {
      title: 'Paraguay launches 44-point national anti-corruption strategy amid institutional crisis',
      source: 'Americas Quarterly',
      link: 'https://americasquarterly.org/article/paraguays-boom/',
      pubDate: new Date('2025-02-20').toISOString()
    },
    {
      title: 'Master Bus to build $30M electric bus factory in Paraguay, creating 1,200 jobs',
      source: 'Insight Crime',
      link: 'https://insightcrime.org/news/election-new-president-suggests-same-old-corruption-paraguay/',
      pubDate: new Date('2025-09-10').toISOString()
    }
  ]),
  storyCount: 15
}

async function addParaguay() {
  console.log('Adding Paraguay to database...\n')

  try {
    const result = await prisma.locationSummary.upsert({
      where: {
        name_type_category: {
          name: PARAGUAY_SUMMARY.name,
          type: PARAGUAY_SUMMARY.type,
          category: 'all'
        }
      },
      create: {
        name: PARAGUAY_SUMMARY.name,
        type: PARAGUAY_SUMMARY.type,
        country: PARAGUAY_SUMMARY.country,
        lat: PARAGUAY_SUMMARY.lat,
        lng: PARAGUAY_SUMMARY.lng,
        category: 'all',
        summary: PARAGUAY_SUMMARY.summary,
        issues: PARAGUAY_SUMMARY.issues,
        topStories: PARAGUAY_SUMMARY.topStories,
        storyCount: PARAGUAY_SUMMARY.storyCount,
        updatedAt: new Date()
      },
      update: {
        summary: PARAGUAY_SUMMARY.summary,
        issues: PARAGUAY_SUMMARY.issues,
        topStories: PARAGUAY_SUMMARY.topStories,
        storyCount: PARAGUAY_SUMMARY.storyCount,
        updatedAt: new Date()
      }
    })

    console.log('✅ Paraguay added/updated successfully')
    console.log('   ID:', result.id)
    console.log('   Name:', result.name)
    console.log('   Location:', `${result.lat}, ${result.lng}`)
    console.log('   Issues:', JSON.parse(result.issues).length)
    console.log('   Stories:', JSON.parse(result.topStories).length)
    console.log()
  } catch (error) {
    console.error('❌ Error processing Paraguay:', error)
    throw error
  }
}

addParaguay()
  .catch(console.error)
  .finally(() => prisma.$disconnect())
