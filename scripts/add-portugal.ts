import { PrismaClient } from '@prisma/client'

const prisma = new PrismaClient()

const summary = `Portugal's 2025 story is one of political fracture at precisely the wrong moment. On May 18, 2025, the country held its third general election in three years‚Äîa symptom of the instability that's become the new normal. The conservative Democratic Alliance (AD) limped to victory with just 89 seats, far short of a majority, while the radical-right Chega party became the second-largest force in parliament, shattering decades of centrist, bipartisan politics. The election was called after a corruption scandal imploded the previous Socialist government, and voters delivered a verdict that settled nothing. The AD will govern as a minority, meaning every major reform‚Äîon immigration, housing, healthcare‚Äîwill require cross-party negotiation in a parliament where the far-right holds veto power. Meanwhile, the problems voters care most about aren't waiting for political stability to arrive. House prices have risen 106% since 2015‚Äîmore than double the EU average‚Äîwhile Portugal remains one of Western Europe's poorest countries. Rents have become unaffordable for ordinary Portuguese, driven up by an influx of wealthy foreigners and digital nomads. Immigration has tripled since 2018, with over 1.5 million legal immigrants now in a country of 10 million, straining public services and fueling backlash. And while tourism brings billions in revenue, it's also pricing locals out of their own cities. The government has pledged 15,000 new affordable homes within three years, but construction takes time, and patience is running out. Portugal is stuck in a toxic loop: political instability prevents bold action on housing and immigration, while the housing and immigration crises deepen political instability. Something has to give.

**The Big Issue 1: Housing Crisis and the Price of Paradise**

Portugal's housing market has become a crisis of affordability that's reshaping the social contract. Between 2015 and 2023, house prices surged 106%‚Äîthe fastest increase in the European Union after Estonia. The culprits are multiple: golden visa programs that attracted wealthy investors (though now scaled back), a surge in short-term Airbnb rentals that gutted the long-term rental market, and an influx of remote workers from wealthier countries who can outbid locals. Lisbon and Porto have become European hotspots for digital nomads, but the flip side is ordinary Portuguese families being priced out of city centers‚Äîand increasingly, out of cities entirely. The price-to-income ratio is among the worst in the developed world. Estimates suggest that in Lisbon, it now takes an average family more than 15 years of income to afford a home, compared to a European average closer to 8-10 years. Rental prices have followed the same trajectory. What was once affordable for young professionals is now accessible only to high earners or those willing to commute hours from the periphery. The government's response‚Äîa state-led push to build 15,000 affordable housing units over three years‚Äîis a start, but critics note the timeline is slow and the scale insufficient. Construction delays, bureaucratic red tape, and NIMBYism ("not in my backyard") from existing homeowners all threaten to derail the plan. Meanwhile, the housing crisis is fueling emigration: young Portuguese, unable to afford homes, are leaving for better opportunities in France, the UK, and Germany. It's a vicious cycle‚Äîbrain drain weakens the economy, which in turn makes it harder to solve the housing problem. The political consequences are clear: housing was the top voter concern in the May 2025 election, and the rise of Chega is partly a backlash against policies seen as favoring foreign investors over locals.

**The Big Issue 2: Immigration Surge and the Backlash**

Portugal's immigration story is dramatic: in 2018, fewer than half a million legal immigrants lived in the country. By early 2025, that number had ballooned to over 1.5 million‚Äîmany of them Brazilians and Asians working in tourism, agriculture, and construction. This represents a tripling of the immigrant population in just seven years, in a country of roughly 10 million people. The numbers are staggering and unprecedented in modern Portuguese history. The backlog tells another story: the Agency for Integration, Migration, and Asylum (AIMA) is still processing over 900,000 immigration cases, with hundreds of thousands of applicants waiting months‚Äîsometimes years‚Äîfor residency cards. The "manifestation of interest" process, designed to streamline applications, has instead become a bureaucratic bottleneck. The delays create a shadow population of people living and working in legal limbo, unable to access full rights or services. The political fallout is significant. Immigration topped the list of voter concerns alongside housing in the May 2025 election, and the success of the far-right Chega party is directly tied to anti-immigration sentiment. Chega's rhetoric blames immigrants for straining public services, driving down wages, and contributing to the housing crisis. The reality is more complex: immigrants are filling critical labor shortages in sectors like hospitality and farming, sectors the economy depends on. But the perception of "too much, too fast" has taken hold, particularly in working-class communities that feel left behind. The AD minority government now faces a dilemma. Any immigration reform will require support from other parties, including potentially Chega, which will demand restrictive measures. But overly harsh policies risk alienating the business community and damaging Portugal's reputation as a welcoming, cosmopolitan society. The government must thread the needle: streamline the backlog, integrate existing immigrants, and slow the inflow‚Äîall while avoiding xenophobia and economic harm. It's a tightrope walk, and the margin for error is slim.

**The Big Issue 3: Economic Growth and the Tourism Double-Edged Sword**

Portugal's economy is a study in contradictions. Growth is forecast at just 1.8% for 2025‚Äîa slowdown from 1.9% in 2024‚Äîdriven by weak external demand as the global economy sputters. The European Commission projects a modest recovery to 2.2% in 2026, but that's contingent on global trade stability and domestic reforms. Inflation, at least, is under control: price pressure has eased significantly, and the European Central Bank's interest rate policies have helped cool the overheating of 2022-2023. But growth remains anemic, and structural problems persist. Tourism is both savior and curse. The sector is booming, with foreign visitors pouring in and spending billions. Post-pandemic, Portugal has positioned itself as a top European destination: sunny, affordable (for foreigners), and politically stable (relatively). But the tourism boom is pricing locals out of their own cities, as mentioned. Restaurants, hotels, and landlords increasingly cater to tourists, not residents. Lisbon's historic neighborhoods are now dominated by Airbnb listings and souvenir shops, while locals struggle to find affordable housing and services. The government faces a choice: cap tourism growth to preserve livability, or let the sector run hot and accept the social consequences. Neither option is politically easy. Beyond tourism, Portugal is trying to attract foreign investment to diversify the economy. The government has made overtures to position the country as a gateway for companies looking to hedge against China risk, leveraging Portugal's EU membership and strategic location. But competition is fierce‚ÄîSpain, Ireland, and Eastern European countries are all playing the same game. Portugal's advantages‚Äîa skilled, English-speaking workforce and competitive labor costs‚Äîare real, but so are its weaknesses: bureaucracy, infrastructure gaps, and a relatively small domestic market. The fiscal picture is stable: public debt is manageable, and EU recovery funds are flowing in. But without stronger growth, Portugal risks being stuck in a low-growth, high-cost trap. The 2025 national budget aims to close gaps and accelerate infrastructure spending, but implementation depends on political stability‚Äîsomething in short supply.

**The International Angle**

Portugal's geopolitical position is quietly significant. As a NATO member and EU stalwart, Lisbon has historically punched above its weight in diplomacy, leveraging its colonial-era ties to Africa and Brazil. In 2025, that role is being tested. The Ukraine war has exposed divisions within the EU, and Portugal has largely aligned with the Brussels consensus: sanctions on Russia, support for Ukraine, and increased defense spending. But Portugal's defense budget remains modest by NATO standards, and the country is not a frontline state in the way Poland or the Baltics are. The government's priority is domestic stability, not geopolitical grandstanding. Portugal's relationship with China is pragmatic. Beijing has invested heavily in Portuguese infrastructure, including ports and energy projects. Lisbon has walked a careful line, welcoming Chinese investment while not alienating the U.S. or Brussels. The golden visa program, which attracted Chinese investors, has been scaled back under pressure from the EU, but economic ties remain strong. Migration also has an international dimension. As a southern EU border state, Portugal is part of the bloc's frontline in managing migration flows from Africa and the Middle East. The backlog at AIMA is partly a result of EU-wide asylum pressures, and Lisbon is calling for more burden-sharing among member states. Whether the rest of Europe listens is another question. Finally, Portugal's upcoming presidency of the EU Council in the first half of 2027 looms as both opportunity and risk. If the country can stabilize its politics and deliver on housing and immigration reforms, it could use the presidency to showcase a model of pragmatic governance. If political chaos continues, Lisbon risks embarrassment on the European stage.

**The Bottom Line**

Portugal in November 2025 is a country at a crossroads. The May election delivered political fragmentation at the worst possible time: a minority government trying to solve urgent crises‚Äîhousing, immigration, economic stagnation‚Äîwithout the parliamentary muscle to act decisively. The rise of the far-right Chega party has ended the era of centrist stability, and every major policy decision now requires coalition-building in a fractious parliament. The housing crisis is existential: without affordable homes, young Portuguese will continue to emigrate, and the social fabric will fray. The government's 15,000-home pledge is a start, but the timeline is slow and the politics are treacherous. Immigration reform is equally fraught: the country needs workers, but the backlage and public backlash demand action. Threading the needle between economic necessity and political pressure will define the AD government's tenure. Economic growth is tepid, and tourism‚Äîthe bright spot‚Äîcomes with costs locals are increasingly unwilling to bear. Watch for the next flashpoint in parliament: a major immigration bill or housing reform will test whether the minority government can govern effectively or whether Portugal is headed for yet another election. Watch the Supreme Court's decisions on asylum policy and EU burden-sharing‚ÄîLisbon's frustration with Brussels is growing. And watch the economic indicators: if growth stays weak and inflation ticks up, the political pressure on the AD will intensify. Portugal's challenges are solvable, but only with political will and stability‚Äîtwo commodities in short supply in 2025.`

async function main() {
  try {
    // Check if Portugal summary already exists
    const existing = await prisma.locationSummary.findFirst({
      where: {
        name: 'Portugal',
        type: 'country',
        category: 'all'
      }
    })

    const issues = JSON.stringify([
      "Housing Crisis and the Price of Paradise",
      "Immigration Surge and the Backlash",
      "Economic Growth and the Tourism Double-Edged Sword",
      "The International Angle"
    ])

    const topStories = JSON.stringify([])

    if (existing) {
      // Update existing record
      const updated = await prisma.locationSummary.update({
        where: { id: existing.id },
        data: {
          summary,
          issues,
          topStories,
          updatedAt: new Date(),
          storyCount: 0
        }
      })
      console.log('‚úÖ Updated Portugal summary:', updated.id)
    } else {
      // Create new record
      const created = await prisma.locationSummary.create({
        data: {
          name: 'Portugal',
          type: 'country',
          country: 'Portugal',
          lat: 39.3999,
          lng: -8.2245,
          category: 'all',
          summary,
          issues,
          topStories,
          storyCount: 0
        }
      })
      console.log('‚úÖ Created Portugal summary:', created.id)
    }

    console.log('\nüìä Summary Statistics:')
    console.log('  Summary length:', summary.length, 'characters')
    console.log('  Issues count:', JSON.parse(issues).length)
  } catch (error) {
    console.error('‚ùå Error:', error)
    throw error
  } finally {
    await prisma.$disconnect()
  }
}

main()
